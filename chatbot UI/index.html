<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name = "viewport" content = "width=device-width, initial-scale=1.0"/>
        <title>Matchai - Your friendly support bot</title>
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <!-- Navigation-->
        <nav>
            <div>Match.ai</div>
            <ul>
                <li>Home</li>
                <li>Resources</li>
                <li>About</li>
                <li>Contact</li>
            </ul>
        </nav>

                
        <!-- Center Content-->
        <section class="center-content">
            <h2>Your friendly neighborhood support bot</h2>
            <p>
                Match.ai is here to give you emotional support, encouragement or just be a listening ear. Just like drinking an ice cold matcha latte or a cup of steaming hot chai, match.ai is here to give you that same energizing calming feeling. Whether you're feeling overwhelmed, stressed, anxious, or just need to vent, give it a text! 
            </p>
            <div class="image-content">
                <img src="matcha.PNG" alt="matcha" style="max-width: 100%; height: auto; border-radius: 8px;">
            </div>
        </section>


        <!-- Chat Widget-->
        <div class="chat-icon" onclick="toggleChat()">"<img src = "chat.png" alt="chat icon" style="width: 60px; height: 60px;"/></div>


        <div class="chat-widget" id="chatWidget">
            <div class="chat-header">
                Match.ai is here for you 
                <span style="cursor: pointer;" onclick="toggleChat()"><3</span>
            </div>
            <div class="chat-body" id="chatBody"></div>
            <div class="chat-input">
                <input type="text" id="userInput" placeholder="Spill the tea..."/>
                <button onclick="sendMessage()">Send</button>
            </div>
        </div>


        <!-- Chat Script-->
        <script>
            function toggleChat(){
                const widget = document.getElementById('chatWidget');
                widget.style.display = widget.style.display === 'flex'? 'none': 'flex';
            }


            async function sendMessage(){
            const input = document.getElementById("userInput");
            const message = input.value.trim();
            if(!message) return;


            appendMessage("You", message);
            input.value="";


            try {
                const response = await fetch("http://127.0.0.1:8000/chat", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ session_id: "user_1", query: message })
                })


                const data = await response.json();
                appendMessage("Bot", data.response);
            } catch(error) {
                appendMessage("Bot", "Oops! Something went wrong.");
            }
        }


            function appendMessage(sender, text){
                const chatBody = document.getElementById("chatBody");
                const p = document.createElement("p");
                p.innerHTML = `<strong>${sender}:</strong> ${text}`;
                chatBody.appendChild(p);
                chatBody.scrollTop = chatBody.scrollHeight; 
            }
        </script>
    </body>
</html>